# Utilities to test SoF Check chess engine

These utilities include:

- [Data extractor from PGNs](#data-extractor-from-pgns)
- [Position cost tester](#position-cost-tester)

## Dependencies

On Debian/Ubuntu, you need to install the following packages:

- `fpc (>= 3.0.0)`
- `lcl-units (>= 2.0)`
- `lcl-utils (>= 2.0)`
- `stockfish`
- `lzma`
- `python3 (>= 3.6)`

## Utilities

### Data extractor from PGNs

This utility prepares the test data for the engine. It extracts all the positions from given PGN
files, and runs Stockfish to get the cost of all the moves. The data generated by this utility
can be used with `engine_test`.

You can use `build_data.sh` script to build the data. Build time is about 23 hours on my laptop,
so it's recommended not to create data manually, but use the prebuilt data files. It is located in
`data/positions.data.lzma`.

### Position cost tester

This utility is mainly used to test the position cost and various search prunings. It works in the
following way:

- gets positions from data files prepared by `build_data.sh`
- runs the engine on each of the positions
- compares the best move and the found move in the following way:
  - suppose that our engine computes on depth `7` and finds move `e2e4`, while Stockfish found move
    `d2d4` on the same depth
  - the _best score_ is the score of `d2d4` on depth `7` as calculated by Stockfish
  - the _calculated score_ is the score of `e2e4` on depth `7` as calculated by Stockfish
  - the _error_ is the difference between the best score and the calculated score
- reports the staticstics (based on given positions and computed _error_)

To use this utility, run `engine_test/engine_test.py`. See help for more details.
